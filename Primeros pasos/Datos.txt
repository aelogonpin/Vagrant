Añadir una primera imagen (Ubuntu Trusty de 64 bits).

vagrant box add ubuntu/trusty64

Uso básico de vagrant: vagrant init, vagrant up, vagrant status, vagrant halt y vagrant destroy.

Creamos un directorio para cada proyecto, accedemos al proyecto y creamos un fichero de configuración básico de vagrant con:

   vagrant init -m ubuntu/trusty64
Levantamos la máquina con, que copiará la imagen como una nueva máquina y la arrancará:

   vagrant up
Accedemos a la máquina con:

   vagrant ssh
Comprobamos en todo momento el estado de la máquina con:

   vagrant status
Podemos parar la máquina con:

   vagrant halt
Si de nuevo levantamos la máquina, se reutilizará la máquina anteriormente creada y los cambios que se hubieran efectuado en ella. Cuando no queramos volver a utilizar esa máquina la eliminamos permanentemente con:

   vagrant destroy







   Uso de una máquina ya configurada, por ejemplo rasmus/php7dev que contiene los paquetes necesarios para ejecutar una aplicación web con PHP7.

Instalamos la imagen:
   vagrant box add rasmus/php7dev
Clonamos el repositorio que contiene el Vagrantfile configurado con las características de esta imagen:

   git clone https://github.com/rlerdorf/php7dev.git
Accedemos al directorio “php7dev”, arrancamos la máquina y accedemos a ella:

   cd php7dev
   vagrant up
   vagrant ssh
Si queremos acceder a la web con php7 basta con poner en el navegador:

   http://192.168.7.7
Ya que la configuración de Vagrant crea una red específica para esa máquina y la configura con esa IP estática.

vagrant ya de por si en los entornos de virtualbox utiliza la herramienta de carpeta compartida para poder realizar 
dichas comparticones de documentos:
Esot se podra utilizar adentro de las maquinas virtuales median el uso de " cd /vagrant"

Para poder ver mas a fondo respecto a los repositorios de los vagrants:
Podemos acceder mediante: "/carpeta_nombre_usuario/.vagrant.d/*


Para reempaquetar un modelo de bo para vagrant podremos realizar las siguientes acciones:
vagrant box repackage centos/7 virtualbox 1703.01

vagrant "comando"
box "atributo"
repackage "accion"
centos/7 "nombre_del_box"
virtualbox "Entorno de virtualizacion"
1703.01 "Version del box"

Dejando en un fichero "*.box"

Ese "*.box" se podra utiliza mediante estos comandos:
vagrant box add my-box name-of-the-box.box
vagrant init my-box
vagrant up




Borrar la imagen de centos

vagrant box remove centos/7
Instalar de nuevo el box de CentOS 7 desde el fichero “.box” en lugar de hacerlo desde Atlas:

vagrant box add package.box --name centos/7



Comprobar si están actualizadas las imágenes:

vagrant box outdated --global
En el caso de imágenes desactualizadas se pueden eliminar con:

vagrant box prune
Para actualizar el box correspondiente a un escenario se utiliza (sólo válido si se ha descargado de Atlas o similar):

vagrant box update






Crear un box de Vagrant desde una máquina virtual de VirtualBox.

Obtenermos el nombre de la máquina virtual:

   VBoxManage list vms
La “empaquetamos” como un box de vagrant con:

   vagrant package --base "Nombre de la MV" --output maquina.box


Aunque la configuración completa de las redes lo dejamos para una sección posterior, una funcionalidad muy útil y sencilla es la redirección de puertos de la red por defecto que utiliza Vagrant (red interna con NAT). Configura un Vagrantfile para que las peticiones al puerto 8080/tcp de la máquina anfitriona se redirijan al puerto 80/tcp de la máquina virtual.

La documentación completa se encuentra en Forwarded Ports.

   ...
   config.vm.network "forwarded_port", guest: 80, host: 8080
   ...
Podemos ver en todo momento los puertos que se har redireccionado con la instrucción:

   vagrant port
Estos cambios se pueden realizar sobre una máquina ya funcionando y para que se apliquen se utiliza la opción:

   vagrant reload



 vagrant list-commands
   Below is a listing of all available Vagrant commands and a brief
   description of what they do.
   box             manages boxes: installation, removal, etc.
   cap             checks and executes capability
   connect         connect to a remotely shared Vagrant environment
   destroy         stops and deletes all traces of the vagrant machine
   docker-exec     attach to an already-running docker container
   docker-logs     outputs the logs from the Docker container
   docker-run      run a one-off command in the context of a container
   global-status   outputs status Vagrant environments for this user
   halt            stops the vagrant machine
   help            shows the help for a subcommand
   init            initializes a new Vagrant environment by creating a Vagrantfile
   list-commands   outputs all available Vagrant subcommands, even non-primary ones
   login           log in to HashiCorp’s Atlas
   package         packages a running vagrant environment into a box
   plugin          manages plugins: install, uninstall, update, etc.
   port            displays information about guest port mappings
   powershell      connects to machine via powershell remoting
   provider        show provider for this environment
   provision       provisions the vagrant machine
   push            deploys code in this environment to a configured destination
   rdp             connects to machine via RDP
   reload          restarts vagrant machine, loads new Vagrantfile configuration
   resume          resume a suspended vagrant machine
   rsync           syncs rsync synced folders to remote machine
   rsync-auto      syncs rsync synced folders automatically when files change
   share           share your Vagrant environment with anyone in the world
   snapshot        manages snapshots: saving, restoring, etc.
   ssh             connects to machine via SSH
   ssh-config      outputs OpenSSH valid configuration to connect to the machine
   status          outputs status of the vagrant machine
   suspend         suspends the machine
   up              starts and provisions the vagrant environment
   version         prints current and latest Vagrant version











vagrant snapshot save apache-limpio
==> apache-limpio: Snapshotting the machine as 'apache-limpio'...
==> apache-limpio: Snapshot saved! You can restore the snapshot at any time by
==> apache-limpio: using `vagrant snapshot restore`. You can delete it using
==> apache-limpio: `vagrant snapshot delete`.






vagrant snapshot restore apache-limpio
   




Podemos acceder a la máquina virtual utilizando la nueva red privada, ya que la máquina anfitriona también está conectada a esa red:

   ssh -i .vagrant/machines/default/virtualbox/private_key vagrant@192.168.33.10








   Configura un entorno de vagrant para que la máquina virtual esté conectada en modo puente a la misma red que la máquina anfitriona.

   config.vm.network  "public_network", bridge: "eth0"
Accedemos a la máquina y vemos las interfaces de red así como la configuración de /etc/network/interfaces:

   ...
   #VAGRANT-BEGIN
   # The contents below are automatically generated by Vagrant. Do not
   modify.
   auto eth1
   iface eth1 inet dhcp
       post-up route del default dev $IFACE || true
   #VAGRANT-END